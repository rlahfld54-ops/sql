ðŸ§© ì‹¤ë¬´ ì‹œë‚˜ë¦¬ì˜¤ ì˜ˆì œ 2
â€œìµœê·¼ 7ì¼ê°„ ìž¬êµ¬ë§¤ìœ¨ì´ ë†’ì€ ê³ ê° ì°¾ê¸°â€
ðŸ“Œ ìƒí™©

â€œìµœê·¼ 7ì¼ ì•ˆì— ì£¼ë¬¸ì„ 2ë²ˆ ì´ìƒ í•œ ê³ ê° ëª©ë¡ì„ ë½‘ì•„ì£¼ì„¸ìš”.â€


ðŸ“‚ í…Œì´ë¸” êµ¬ì¡°
users (
  user_id     INT,
  signup_date DATE
)

orders (
  order_id    INT,
  user_id     INT,
  order_date  DATETIME,
  status      VARCHAR
)


ðŸ“Œ ìœ íš¨ ì£¼ë¬¸ ì¡°ê±´

status = 'COMPLETED' *êµ¬ë§¤í•œ ì‚¬ëžŒì„ COMPLETEDë¼ê³  ìƒíƒœê°€ ë°”ë€œ


#ë‚´ê°€ ìƒê°í•œ ì¿¼ë¦¬
select u.user_id
from users u
join orders o
on u.user_id = o.user_id
where order_date >= today()-7
and order_date =< today()
and o.status = 'COMPLETED'
group by u.user_id
having count(u.user_id)>=2;


user_idë§Œ í•„ìš”í•œë° join ë¶ˆí•„ìš”í•˜ë‹¤. orders í…Œì´ë¸”ì—ì„œ í•´ê²°ê°€ëŠ¥
JOINì€ ìŠµê´€ì ìœ¼ë¡œ ì“°ì§€ ë§ ê²ƒ

COUNT ëŒ€ìƒì€ â€œì˜ë¯¸â€ ê¸°ì¤€ìœ¼ë¡œ

âœ… ë” ëª…í™•í•œ í‘œí˜„
HAVING COUNT(o.order_id) >= 2


ðŸ‘‰ â€œì£¼ë¬¸ 2ê±´ ì´ìƒâ€ì´ ë¶„ëª…í•´ì§

* ë‚´ê°€ ì´ë ‡ê²Œ ìž‘ì„±í•œ ì´ìœ   :: having count(u.user_id)>=2;
order_idëŠ” ì£¼ë¬¸ë²ˆí˜¸ë¼ê³  ìƒê°í•˜ëŠ”ë° ë³´í†µ ì‡¼í•‘ëª°ë³´ë©´ 65464154 ì´ëŸ° ì‹ìœ¼ë¡œ ì í˜€ìžˆì–´ì„œ
êµ¬ë¶„í•˜ê¸° ì• ë§¤í•˜ë‹¤ê³  ìƒê°í–ˆìŒ. ê·¸ëž˜ì„œ 1ì •ê·œí™”ì²˜ëŸ¼ user_idë¥¼ ì‚¬ìš©í•´ì•¼ê² ë‹¤ê³  íŒë‹¨í•¨
ê·¼ë° ì§€ê¸ˆ ë‹¤ì‹œ ìƒê°í•´ë³´ë‹ˆê¹Œ ì£¼ë¬¸ë²ˆí˜¸ê°€ ì¤‘ë³µë ë¦¬ê°€ ì—†ëŠ”ë°..?
o.order_idê°€ ë§žë„¤


#ë‹µ
SELECT
    o.user_id
FROM orders o
WHERE o.order_date >= NOW() - INTERVAL 7 DAY
  AND o.order_date < NOW()
  AND o.status = 'COMPLETED'
GROUP BY o.user_id
HAVING COUNT(*) >= 2;
